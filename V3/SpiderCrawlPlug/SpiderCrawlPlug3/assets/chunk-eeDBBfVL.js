import{d as q,r as k,c as C,o as j,a as b,b as x}from"./chunk-BZa7IkcD.js";const R=["href"],B=q({__name:"DevTools",setup(P){const w=k("https://github.com/guocaoyi/create-chrome-ext"),f=chrome.devtools,r=(...o)=>f.inspectedWindow.eval(`console.log(...${JSON.stringify(o)});`);let l=2,u="SpiderCrawlData",m=null,p=null;return r("SpiderCrawl db_version:",l,"db_name:",u),chrome.devtools.network.onRequestFinished.addListener(async(...o)=>{if(chrome.storage.sync.get(["spiderSwitch","hookRequest"],e=>{m=e.spiderSwitch,p=e.hookRequest}),m)try{const[{request:{method:e,queryString:h,url:i,postData:g},response:{bodySize:v,status:S,header:D},getContent:d}]=o;var n=(new Date().getTime()+480*60*1e3).toString();const _=await new Promise((t,a)=>d(t)),s={...{...o[0],content:_},timestamp:n},c=indexedDB.open(u,l);c.onupgradeneeded=function(t){const a=t.target.result;a.objectStoreNames.contains("myDataStore")||a.createObjectStore("myDataStore",{keyPath:"id",autoIncrement:!0})},c.onsuccess=function(t){t.target.result.transaction("myDataStore","readwrite").objectStore("myDataStore").add(s)},c.onerror=function(t){r("SpiderCrawl onerror",t.target.errorCode)}}catch(e){r(e.stack||e.toString())}if(p)try{const[{request:{method:e,queryString:h,url:i,postData:g},response:{bodySize:v,status:S,header:D},getContent:d}]=o;var n=(new Date().getTime()+480*60*1e3).toString();const y=await new Promise((t,a)=>d(t)),s={...o[0],content:y},c={...s,timestamp:n};r(`[Request] ${e} ${i}`,`
[params]`,h,`
[data]`,g),r("[Response]",S,i,s)}catch(e){r(e.stack||e.toString())}}),(o,n)=>(j(),C("main",null,[n[0]||(n[0]=b("h3",null,"DevTools Page",-1)),b("a",{href:w.value,target:"_blank"}," generated by create-chrome-ext ",8,R)]))}});chrome.devtools.panels.create("VueCrx","","../../devtools.html",function(){console.log("devtools panel create")});x(B).mount("#app");
